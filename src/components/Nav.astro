---
import useTranslations from "@utils/i18n";
import { Icon } from "astro-icon/components";

const t = useTranslations(Astro.currentLocale || "es");

const navItems = [
  { href: "#home", icon: "home", label: t("nav.home") },
  { href: "#experience", icon: "briefcase", label: t("nav.experience") },
  { href: "#projects", icon: "code", label: t("nav.projects") },
  { href: "#technologies", icon: "tools", label: t("nav.technologies") },
  { href: "#aboutMe", icon: "user", label: t("nav.aboutMe") },
  { href: "#contact", icon: "mail", label: t("nav.contact") },
];


---

<nav>
  <div class="relative flex justify-center">

    <div id="menu-btn" class="fixed top-5 hidden left-5 items-center gap-2 text-5xl z-10
         bg-white/10 backdrop-blur-md border border-white/50
         px-3 py-1 rounded-xl text-amber-50
         hover:bg-white/10 transition-all duration-300 h-[60px] max-[1090px]:flex cursor-pointer">
        <Icon name="menu" color="white">
    </div>

    <ul
      id="menu"
      class="flex justify-center gap-x-2 mt-5 px-2 py-2 rounded-2xl shadow-fancy fixed z-10
             bg-white/10 backdrop-blur-md border border-white/50  text-amber-50 max-[1090px]:hidden max-[1090px]:flex-col max-[1090px]:w-full max-[1090px]:h-full max-[1090px]:gap-y-5"
    >
    <span id="close-btn" class="absolute text-5xl top-0 left-12 cursor-pointer hidden">x</span>
      {
        navItems.map((item) => (
          <li>
            <a
              href={item.href}
              class="flex relative justify-center items-center gap-1 px-3 py-1 rounded-xl
                     transition-all duration-300 ease-out z-50
                     hover:bg-white/10 hover:backdrop-blur-sm hover:shadow-lg hover:shadow-white/10"
            >
              {item.icon && (
                <Icon name={item.icon} size={30} color={"#ec4899"} />
              )}
              {item.label}
            </a>
          </li>
        ))
      }
    </ul>

    <div
      id="select-idiom"
      class="fixed top-5 right-5 z-5
         flex items-center gap-2 
         bg-white/10 backdrop-blur-md border border-white/50
         px-3 py-1 rounded-xl text-amber-50
         hover:bg-white/10 transition-all duration-300 h-14"
    >
      <img
        src={Astro.currentLocale === "en" ? "/flags/en.png" : "/flags/es.png"}
        alt="flag"
        class="w-6 h-6 rounded-sm"
      />

      <select
        class="bg-transparent text-amber-50 focus:outline-none cursor-pointer flex"
        onchange="location.href = this.value"
      >
        <option value="/es" selected={Astro.currentLocale === "es"}>
          ES
        </option>
        <option value="/en" selected={Astro.currentLocale === "en"}>EN</option>
      </select>
    </div>

  </div>
</nav>

<script>
  const btn = document.getElementById("menu-btn");
  const menu = document.getElementById("menu");
  const closeMenuBtn = document.getElementById("close-btn");
  const overlay = document.getElementById("overlay");

  btn?.addEventListener("click", () => {
     menu?.classList.toggle("max-[1090px]:hidden");
     closeMenuBtn?.classList.toggle("hidden");
     overlay?.classList.toggle("hidden");
  });

  closeMenuBtn?.addEventListener("click", () => {
     menu?.classList.toggle("max-[1090px]:hidden");
     closeMenuBtn?.classList.toggle("hidden");
     overlay?.classList.toggle("hidden");
  });

  const menuLinks = menu?.querySelectorAll("a");

  menuLinks?.forEach((link) => {
    link.addEventListener("click", () => {
      menu?.classList.add("max-[1090px]:hidden"); 
      closeMenuBtn?.classList.add("hidden");
      if (window.innerWidth < 1090) overlay?.classList.toggle("hidden");
    });
  });
</script>